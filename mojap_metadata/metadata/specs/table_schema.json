{
    "$schema": "http://json-schema.org/draft-07/schema",
    "type": "object",
    "title": "Metadata",
    "description": "MoJ Data Catalogue Metadata",
    "required": [
        "name",
        "columns"
    ],
    "properties": {
        "name": {
            "type": "string",
            "title": "The name of the table in the database"
        },
        "description": {
            "type": "string",
            "title": "A description of what this table contains"
        },
        "format": {
            "type": "string",
            "title": "The format the data is stored in"
        },
        "sensitive": {
            "type": "boolean",
            "title": "Specifies whether the table contains any sensitive data",
            "default": false
        },
        "primary_key": {
            "type": "array",
            "uniqueItems": true,
            "items": {
                "type": "string"
            },
            "title": "Columns that form the primary key of the table",
            "default": []
        },
        "partitions": {
            "type": "array",
            "uniqueItems": true,
            "items": {
                "type": "string"
            },
            "title": "Columns used to partition the table",
            "default": []
        },
        "columns": {
            "type": "array",
            "title": "The columns in the table. An array of objects",
            "items": {
                "type": "object",
                "required": [
                    "name"
                ],
                "anyOf": [
                    {
                        "required": [
                            "type"
                        ]
                    },
                    {
                        "required": [
                            "type_category"
                        ]
                    }
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "title": "The column name"
                    },
                    "description": {
                        "type": "string",
                        "title": "A description of this field",
                        "default": ""
                    },
                    "type": {
                        "type": "string",
                        "title": "The data type. Should be one of the Arrow types",
                        "enum": [
                            "null",
                            "bool_",
                            "int8",
                            "int16",
                            "int32",
                            "int64",
                            "uint8",
                            "uint16",
                            "uint32",
                            "uint64",
                            "float16",
                            "float32",
                            "float64",
                            "time32",
                            "time64",
                            "timestamp",
                            "date32",
                            "date64",
                            "binary",
                            "string",
                            "utf8",
                            "large_binary",
                            "large_string",
                            "large_utf8",
                            "decimal128",
                            "list_",
                            "large_list",
                            "map_",
                            "struct",
                            "dictionary",
                            "field",
                            "schema"
                        ]
                    },
                    "type_category": {
                        "type": "string",
                        "title": "The type category. The 'type' can be inferred from this if it is not provided",
                        "enum": [
                            "integer",
                            "float",
                            "string",
                            "date",
                            "datetime",
                            "boolean",
                            "array",
                            "object"
                        ]
                    },
                    "nullable": {
                        "type": "boolean",
                        "title": "Specifies if column is nullable (can have missing values) or not (cannot have missing values)"
                    },
                    "sensitive": {
                        "type": "boolean",
                        "title": "Specifies if the column contains personal or special category data"
                    },
                    "alias": {
                        "type": "string",
                        "title": "If this column contains a standard ID or other linking field but has a non-standard name, the alias can provide the standard name",
                        "examples": [
                            "nomis_id"
                        ]
                    },
                    "foreign_key": {
                        "type": "array",
                        "title": "The list of foreign key relationships this column has, if any",
                        "default": [],
                        "examples": [
                            [
                                {
                                    "table": "",
                                    "columns": []
                                }
                            ]
                        ],
                        "items": {
                            "anyOf": [
                                {
                                    "type": "object",
                                    "default": {},
                                    "examples": [
                                        {
                                            "table": "",
                                            "columns": []
                                        }
                                    ],
                                    "required": [
                                        "table",
                                        "columns"
                                    ],
                                    "properties": {
                                        "table": {
                                            "type": "string",
                                            "title": "The table name",
                                            "default": "",
                                            "examples": [
                                                ""
                                            ]
                                        },
                                        "columns": {
                                            "type": "array",
                                            "title": "The list of column names",
                                            "default": []
                                        }
                                    },
                                    "additionalProperties": true
                                }
                            ]
                        }
                    },
                    "unique": {
                        "type": "boolean",
                        "title": "Specifies if the values in the column must be unique",
                        "default": false
                    },
                    "enum": {
                        "type": "array",
                        "title": "An array of valid values that can exist in this column. Note NULL/None is not required, please use nullable property to define if column is nullable.",
                        "examples": [
                            [
                                "Y",
                                "N"
                            ],
                            [
                                0,
                                1,
                                2,
                                3,
                                4
                            ],
                            [
                                "England",
                                "Northern Ireland",
                                "Scotland",
                                "Wales"
                            ]
                        ]
                    },
                    "pattern": {
                        "type": "string",
                        "title": "regex pattern that can be used to validate data in this column"
                    },
                    "minimum": {
                        "type": [
                            "null",
                            "number"
                        ],
                        "title": "The minumum value a numerical type can take",
                        "default": null
                    },
                    "maximum": {
                        "type": [
                            "null",
                            "number"
                        ],
                        "title": "The maximum value a numerical type can take",
                        "default": null
                    },
                    "minLength": {
                        "type": [
                            "null",
                            "number"
                        ],
                        "title": "The minimum length a string type can have",
                        "default": null
                    },
                    "maxLength": {
                        "type": [
                            "null",
                            "number"
                        ],
                        "title": "The maximum length a string type can have",
                        "default": null
                    }
                },
                "additionalProperties": true
            }
        }
    },
    "additionalProperties": true
}