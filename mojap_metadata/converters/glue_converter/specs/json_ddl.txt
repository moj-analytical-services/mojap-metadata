CREATE EXTERNAL TABLE {{database}}.{{Name}} (
{% for c in StorageDescriptor.Columns -%} 
    `{{c.Name}}` {{c.Type}} COMMENT `{{c.Comment}}`
{% endfor -%}
)
{% if PartitionKeys -%}
PARTITION BY (
{% for p in PartitionKeys -%}
    `{{p.Name}}` {{p.Type}} COMMENT `{{p.Comment}}`
{% endfor -%}
)
{% endif -%}
ROW FORMAT SERDE
    '{{StorageDescriptor.SerdeInfo.SerializationLibrary}}'
WITH SERDEPROPERTIES (
    'paths'='{{json_col_paths}}'
)
STORED AS INPUTFORMAT
    '{{StorageDescriptor.InputFormat}}'
OUTPUTFORMAT
    '{{StorageDescriptor.OutputFormat}}'
LOCATION
    '{{StorageDescriptor.Location}}'
TBLPROPERTIES (
    'classification'='json'
);
