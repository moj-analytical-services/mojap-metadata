CREATE EXTERNAL TABLE {{database}}.{{table}} (
{% for c in columns -%} 
    `{{c.name}}` {{c.type}} COMMENT `{{c.description}}`
{% endfor -%}
)
{% if partitions -%}
PARTITION BY (
{% for p in partitions -%}
    `{{p.name}}` {{p.type}} COMMENT `{{p.description}}`
{% endfor -%}
)
{% endif -%}
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
ROW FORMAT DELIMITED
    FIELDS TERMINATED BY '{{sep}}'
    ESCAPED BY '{{escape_char}}'
    LINES TERMINATED BY '{{line_term_char}}'
STORED AS INPUTFORMAT
    'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
    'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
    '{{location}}'
TBLPROPERTIES (
    'classification'='csv',
{% if skip_header -%}
    'skip.header.line.count'='1'
{%- endif -%}
);
