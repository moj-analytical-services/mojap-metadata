CREATE EXTERNAL TABLE {{database}}.{{Name}} (
{% for c in StorageDescriptor.Columns -%} 
    `{{c.Name}}` {{c.Type}} COMMENT `{{c.Comment}}`
{% endfor -%}
)
{% if PartitionKeys -%}
PARTITION BY (
{% for p in PartitionKeys -%}
    `{{p.Name}}` {{p.Type}} COMMENT `{{p.Comment}}`
{% endfor -%}
)
{% endif -%}
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
{% if StorageDescriptor.SerdeInfo.Parameters -%}
WITH SERDEPROPERTIES (
    {% if csv_serde_properties.raw_sep -%}
    'separatorChar' = '{{csv_serde_properties.raw_sep}}',
    {% endif -%}
    {% if csv_serde_properties.raw_quote -%}
    'quoteChar' = '{{csv_serde_properties.raw_quote}}',
    {% endif -%}
    {% if csv_serde_properties.raw_escape -%}
    'escapeChar' = '{{csv_serde_properties.raw_escape}}',
    {%- endif %}
)
{% endif -%}
STORED AS INPUTFORMAT
    'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
    'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
    '{{StorageDescriptor.Location}}'
TBLPROPERTIES (
    'classification'='csv',
{% if "skip.header.line.count" in StorageDescriptor.Parameters -%}
    'skip.header.line.count' = '1'
{%- endif -%}
);
