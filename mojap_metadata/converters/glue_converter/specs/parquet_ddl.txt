CREATE EXTERNAL TABLE {{database}}.{{Name}} (
{% for c in StorageDescriptor.Columns -%} 
    `{{c.Name}}` {{c.Type}} COMMENT `{{c.Comment}}`
{% endfor -%}
)
{% if PartitionKeys -%}
PARTITION BY (
{% for p in PartitionKeys -%}
    `{{p.Name}}` {{p.Type}} COMMENT `{{p.Comment}}`
{% endfor -%}
)
{% endif -%}
ROW FORMAT SERDE
    'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
    'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
    'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
    '{{StorageDescriptor.Location}}'
TBLPROPERTIES (
    'classification'='parquet',
    {% if StorageDescriptor.Parameters.compressionType -%}
    'parquet.compression'='{{StorageDescriptor.Parameters.compressionType}}'
    {%- endif %}
);
